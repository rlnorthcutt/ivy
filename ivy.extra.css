/*!
 * Ivy Extra — optional polish for Ivy.css (CLASSLESS)
 * Version: 1.0.0-extra
 * URL: https://github.com/rlnorthcutt/ivy
 * Copyright (c) 2025 Ron Northcutt
 * License: MIT (https://opensource.org/licenses/MIT)
 *
 * Requires: ivy.css (CORE). Works great with Lattice.css for layout.
 *
 * Scope (EXTRA):
 * - Buttons (semantic + a11y) with opt-in variants via [data-variant].
 * - Details/summary, tooltips, dialog, progress, breadcrumbs.
 * - Advanced form touches: accent-color, switches, range, file button.
 * - Table striping (opt-in), small badges, busy/spinner helper.
 * Notes: classless first; no containers or layout. Keep overrides minimal.
 */

/* ==========================================================================
   0) Extra tokens — surfaces, primary, ring, shadows
   ========================================================================== */
:root{
  --surface-2:#f5f7fa; --surface-3:#eef2f7;
  --primary:var(--color-link); --on-primary:#ffffff;
  --ring-color:color-mix(in oklab,var(--primary) 75%,#000 0%);
  --ring:2px solid var(--ring-color);
  --shadow-sm:0 1px 2px rgba(0,0,0,.06),0 1px 1px rgba(0,0,0,.04);
  --shadow-md:0 4px 10px rgba(0,0,0,.08),0 2px 4px rgba(0,0,0,.06);
}
@media (prefers-color-scheme:dark){
  :root{--surface-2:#0f1216; --surface-3:#12161b; --on-primary:#0b0d10;}
}

/* ==========================================================================
   1) Buttons — semantic elements + opt-in variants
   - base styles apply to <button>, inputs, and <a role="button">
   - variants opt-in: [data-variant="primary"|"outline"|"ghost"]
   - size opt-in: [data-size="sm"|"lg"]
   ========================================================================== */
button,[type=button],[type=submit],[type=reset],a[role=button]{
  display:inline-block; border:1px solid var(--color-border); border-radius:.5rem;
  background:var(--surface-2); color:inherit; padding:.55em .9em; line-height:1.25;
  text-decoration:none; box-shadow:var(--shadow-sm); transition:transform .06s ease,
  background-color .15s ease,border-color .15s ease,box-shadow .15s ease;
}
button:hover,[type=button]:hover,[type=submit]:hover,[type=reset]:hover,a[role=button]:hover{
  background:var(--surface-3);}
button:active,[type=button]:active,[type=submit]:active,[type=reset]:active,a[role=button]:active{
  transform:translateY(1px);}
button:focus-visible,[type=button]:focus-visible,[type=submit]:focus-visible,
[type=reset]:focus-visible,a[role=button]:focus-visible{outline:var(--ring); outline-offset:2px;}
button:disabled,[type=button]:disabled,[type=submit]:disabled,[type=reset]:disabled{
  opacity:.6; cursor:not-allowed;}
/* primary */
[data-variant=primary]{background:var(--primary) !important; color:var(--on-primary) !important;
  border-color:color-mix(in oklab,var(--primary) 70%,#000 0%);}
[data-variant=primary]:hover{filter:saturate(1.05) brightness(1.02);}
[data-variant=primary]:active{filter:saturate(1.1) brightness(.98);}
/* outline */
[data-variant=outline]{background:transparent !important; color:var(--primary) !important;
  border-color:var(--primary);}
/* ghost */
[data-variant=ghost]{background:transparent !important; border-color:transparent;
  color:var(--primary);}
[data-size=sm]{padding:.4em .7em; font-size:.925em;}
[data-size=lg]{padding:.7em 1.1em; font-size:1.05em;}

/* ==========================================================================
   2) Details / summary — disclosure with better affordance
   ========================================================================== */
details{border:1px solid var(--color-border); border-radius:.5rem; padding:.5rem .75rem;
  background:var(--surface-2);}
details+details{margin-top:.75rem;}
summary{cursor:pointer; font-weight:600; list-style:none;}
summary::-webkit-details-marker{display:none;}
details[open]{background:var(--surface-3);}
details[open]>summary{margin-bottom:.5rem;}

/* ==========================================================================
   3) Tooltips — opt-in via [data-tooltip] and optional [data-placement]
   ========================================================================== */
[data-tooltip]{position:relative;}
[data-tooltip]::after{content:attr(data-tooltip); position:absolute; white-space:nowrap;
  inset:auto auto calc(100% + .5rem) 50%; transform:translateX(-50%); pointer-events:none;
  background:#111; color:#fff; padding:.35em .5em; border-radius:.35rem; font-size:.85em;
  opacity:0; translate:0 .25rem; transition:opacity .15s ease,translate .15s ease;
  z-index:50;}
[data-tooltip]:hover::after,[data-tooltip]:focus-within::after{opacity:1; translate:0 0;}
/* placements: top (default), right, bottom, left */
[data-placement=right]::after{inset:50% auto auto calc(100% + .5rem); transform:translateY(-50%);}
[data-placement=bottom]::after{inset:calc(100% + .5rem) auto auto 50%; transform:translateX(-50%);}
[data-placement=left]::after{inset:50% calc(100% + .5rem) auto auto; transform:translateY(-50%);}

/* ==========================================================================
   4) Dialog (<dialog>) — minimal modal styling
   ========================================================================== */
dialog{border:1px solid var(--color-border); border-radius:.75rem; padding:0; margin:auto;
  background:var(--color-bg); color:inherit; box-shadow:var(--shadow-md); max-width:48rem;}
dialog>article{padding:1rem 1.25rem;}
dialog::backdrop{background:color-mix(in oklab,#000 60%,transparent); backdrop-filter:saturate(.9);}

/* ==========================================================================
   5) Progress — simple, theme-aware
   ========================================================================== */
progress{width:100%; height:.5rem; appearance:none; border:0; background:var(--surface-2);
  border-radius:999px; overflow:hidden;}
progress::-webkit-progress-bar{background:var(--surface-2);}
progress::-webkit-progress-value{background:var(--primary);}
progress::-moz-progress-bar{background:var(--primary);}

/* ==========================================================================
   6) Tables (opt-in striping) — add data-striped to <table>
   ========================================================================== */
table[data-striped] tbody tr:nth-child(odd){background:color-mix(in oklab,
  var(--surface-2) 70%,transparent);}
tfoot td,tfoot th{color:var(--color-muted); font-weight:500;}

/* ==========================================================================
   7) Forms — accent-color, switches, range, file button
   ========================================================================== */
/* accent-color applies broadly to checks/radios/progress */
:where(input[type=checkbox],input[type=radio],progress){accent-color:var(--primary);}
/* switch pattern: <input type="checkbox" role="switch"> */
input[type=checkbox][role=switch]{appearance:none; width:2.5rem; height:1.35rem; border-radius:999px;
  background:var(--surface-3); position:relative; border:1px solid var(--color-border);
  vertical-align:middle; outline:none; transition:background .15s;}
input[role=switch]::after{content:""; position:absolute; left:.15rem; top:50%;
  width:1rem; height:1rem; transform:translateY(-50%); background:#fff; border-radius:999px;
  box-shadow:var(--shadow-sm); transition:left .15s;}
input[role=switch]:checked{background:color-mix(in oklab,var(--primary) 40%,var(--surface-3));}
input[role=switch]:checked::after{left:calc(100% - 1.15rem);}
input[role=switch]:focus-visible{outline:var(--ring); outline-offset:2px;}
/* range */
input[type=range]{appearance:none; width:100%; height:.25rem; border-radius:999px;
  background:var(--surface-3);}
input[type=range]::-webkit-slider-thumb{appearance:none; width:1rem; height:1rem; border-radius:50%;
  background:var(--primary); border:2px solid var(--color-bg); box-shadow:var(--shadow-sm);}
input[type=range]::-moz-range-thumb{width:1rem; height:1rem; border-radius:50%;
  background:var(--primary); border:2px solid var(--color-bg); box-shadow:var(--shadow-sm);}
input[type=range]:focus-visible{outline:var(--ring); outline-offset:6px;}
/* file input button */
input[type=file]::-webkit-file-upload-button{border:1px solid var(--color-border);
  border-radius:.5rem; padding:.45em .8em; background:var(--surface-2); cursor:pointer;}
input[type=file]::file-selector-button{border:1px solid var(--color-border); border-radius:.5rem;
  padding:.45em .8em; background:var(--surface-2); cursor:pointer;}
input[type=file]::file-selector-button:hover{background:var(--surface-3);}

/* ==========================================================================
   8) Breadcrumbs — semantic: <nav aria-label="breadcrumb"><ol>…</ol></nav>
   ========================================================================== */
nav[aria-label=breadcrumb] ol{display:flex; flex-wrap:wrap; gap:.35rem .5rem; padding:0;
  margin:0; list-style:none;}
nav[aria-label=breadcrumb] li{display:flex; align-items:center; color:var(--color-muted);}
nav[aria-label=breadcrumb] li+li::before{content:"/"; margin:0 .35rem; color:var(--color-border);}
nav[aria-label=breadcrumb] a{text-decoration:none;}
nav[aria-label=breadcrumb] a:hover{text-decoration:underline;}
nav[aria-label=breadcrumb] [aria-current=page]{color:inherit; font-weight:600;}

/* ==========================================================================
   9) Badges — tiny label chips (opt-in attribute)
   ========================================================================== */
[aria-label][data-badge]{position:relative;}
[aria-label][data-badge]::after{content:attr(data-badge); position:absolute; top:-.4em; right:-.4em;
  font-size:.7em; line-height:1; background:var(--primary); color:var(--on-primary);
  border-radius:999px; padding:.25em .45em; box-shadow:var(--shadow-sm);}

/* ==========================================================================
   10) Busy/spinner — attribute-driven, no extra markup
   - Add [aria-busy="true"] to any element; a spinner appears in the corner.
   ========================================================================== */
@keyframes ivy-spin{to{transform:rotate(1turn);}}
[aria-busy=true]{position:relative;}
[aria-busy=true]::after{content:""; position:absolute; inset:auto .35rem .35rem auto; width:.9rem;
  height:.9rem; border:2px solid color-mix(in oklab,var(--primary) 20%,transparent);
  border-top-color:var(--primary); border-radius:50%; animation:ivy-spin .8s linear infinite;}

/* ==========================================================================
   11) Small helpers — muted text and inline code tweak
   ========================================================================== */
.muted{color:var(--color-muted) !important;}
p>code{padding:.08em .3em;}
