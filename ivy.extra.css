/*!
 * Ivy Extra — optional polish for Ivy.css (CLASSLESS)
 * Version: 1.1.0-extra
 * URL: https://github.com/rlnorthcutt/ivy
 * License: MIT (https://opensource.org/licenses/MIT)
 */

/** Requires: ivy.css (CORE). Works great with Lattice.css for layout.
 * Scope (EXTRA):
 * - Buttons (semantic + a11y) with opt-in variants via [data-variant].
 * - Details/summary, tooltips, dialog, progress, breadcrumbs.
 * - Advanced form touches: accent-color, switches, range, file button.
 * - Table striping (opt-in), badges, busy/spinner helper.
 * - Card/box containers, callouts, button & input groups, compact/dense tables, utilities.
 * Notes: classless-first; minimal overrides; reuse Ivy core tokens.
 */

/* ==========================================================================
   0) Extra tokens — surfaces, primary, shadows
   ========================================================================== */
:root{
  --surface-2:#f5f7fa; --surface-3:#eef2f7;
  --primary:var(--color-link); --on-primary:#ffffff;
  --shadow-sm:0 1px 2px rgba(0,0,0,.06),0 1px 1px rgba(0,0,0,.04);
  --shadow-md:0 4px 10px rgba(0,0,0,.08),0 2px 4px rgba(0,0,0,.06);
}
@media (prefers-color-scheme:dark){
  :root{
    --surface-2:#0f1216; --surface-3:#12161b; --on-primary:#0b0d10;
    --shadow-sm:0 1px 2px rgba(0,0,0,.5),0 0 0 1px rgba(255,255,255,.06);
    --shadow-md:0 8px 24px rgba(0,0,0,.45),0 4px 12px rgba(0,0,0,.35),0 0 0 1px rgba(255,255,255,.07);
  }
}

/* ==========================================================================
   1) Buttons — semantic elements + opt-in variants
   ========================================================================== */
button,[type=button],[type=submit],[type=reset],a[role=button]{
  display:inline-block; border:var(--bw-1) solid var(--color-border); border-radius:var(--radius);
  background:var(--surface-2); color:inherit; padding:.55em .9em; line-height:1.25; text-decoration:none;
  box-shadow:var(--shadow-sm); transition:transform .06s ease,background-color .15s ease,border-color .15s ease,box-shadow .15s ease;
}
button:hover,[type=button]:hover,[type=submit]:hover,[type=reset]:hover,a[role=button]:hover{background:var(--surface-3);}
button:active,[type=button]:active,[type=submit]:active,[type=reset]:active,a[role=button]:active{transform:translateY(1px);}
@media (prefers-reduced-motion:reduce){
  button:active,[type=button]:active,[type=submit]:active,[type=reset]:active,a[role=button]:active{transform:none;}
}
button:focus-visible,[type=button]:focus-visible,[type=submit]:focus-visible,[type=reset]:focus-visible,a[role=button]:focus-visible{
  outline:var(--focus-ring) solid var(--primary); outline-offset:2px;
}
button:disabled,[type=button]:disabled,[type=submit]:disabled,[type=reset]:disabled{opacity:.6; cursor:not-allowed;}
/* variants */
[data-variant=primary]{background:var(--primary)!important; color:var(--on-primary)!important; border-color:color-mix(in oklab,var(--primary) 70%,#000 0%);}
[data-variant=primary]:hover{filter:saturate(1.05) brightness(1.02);}
[data-variant=primary]:active{filter:saturate(1.1) brightness(.98);}
[data-variant=outline]{background:transparent!important; color:var(--primary)!important; border-color:var(--primary);}
[data-variant=ghost]{background:transparent!important; border-color:transparent; color:var(--primary);}
[data-size=sm]{padding:.4em .7em; font-size:.925em;}
[data-size=lg]{padding:.7em 1.1em; font-size:1.05em;}

/* ==========================================================================
   2) Details / summary — disclosure
   ========================================================================== */
details{
  border:var(--bw-1) solid var(--color-border); border-radius:var(--radius);
  padding:var(--m-0_5) var(--m-0_75); background:var(--surface-2);
}
details+details{margin-top:var(--m-0_75);}
summary{cursor:pointer; font-weight:600; list-style:none;}
summary::-webkit-details-marker{display:none;}
details[open]{background:var(--surface-3);}
details[open]>summary{margin-bottom:var(--m-0_5);}

/* ==========================================================================
   3) Tooltips — [data-tooltip]
   ========================================================================== */
[data-tooltip]{position:relative;}
[data-tooltip]::after{
  content:attr(data-tooltip); position:absolute; white-space:nowrap;
  inset:auto auto calc(100% + var(--m-0_5)) 50%; transform:translateX(-50%); pointer-events:none;
  background:color-mix(in oklab,var(--color-text) 93%,transparent); color:var(--color-bg);
  padding:.35em .5em; border-radius:.35rem; font-size:.85em; opacity:0; translate:0 .25rem;
  transition:opacity .15s ease,translate .15s ease; box-shadow:var(--shadow-sm); z-index:50;
}
[data-tooltip]:hover::after,[data-tooltip]:focus-within::after{opacity:1; translate:0 0;}
[data-placement=right]::after{inset:50% auto auto calc(100% + var(--m-0_5)); transform:translateY(-50%);}
[data-placement=bottom]::after{inset:calc(100% + var(--m-0_5)) auto auto 50%; transform:translateX(-50%);}
[data-placement=left]::after{inset:50% calc(100% + var(--m-0_5)) auto auto; transform:translateY(-50%);}

/* ==========================================================================
   4) Dialog (<dialog>)
   ========================================================================== */
dialog{
  border:var(--bw-1) solid var(--color-border); border-radius:.75rem; padding:0; margin:auto;
  background:var(--color-bg); color:inherit; box-shadow:var(--shadow-md); max-width:48rem;
}
dialog>article{padding:var(--m) var(--m-0_75);}
dialog::backdrop{background:color-mix(in oklab,#000 55%,transparent); backdrop-filter:saturate(.95) blur(1px);}

/* ==========================================================================
   5) Progress
   ========================================================================== */
progress{width:100%; height:.5rem; appearance:none; border:0; background:var(--surface-2); border-radius:999px; overflow:hidden;}
progress::-webkit-progress-bar{background:var(--surface-2);}
progress::-webkit-progress-value{background:var(--primary);}
progress::-moz-progress-bar{background:var(--primary);}

/* ==========================================================================
   6) Tables (striping)
   ========================================================================== */
table[data-striped] tbody tr:nth-child(odd){background:color-mix(in oklab,var(--surface-2) 70%,transparent);}
tfoot td,tfoot th{color:var(--color-muted); font-weight:500;}

/* ==========================================================================
   7) Forms — accent, switches, range, file button
   ========================================================================== */
:where(input[type=checkbox],input[type=radio],progress){accent-color:var(--primary);}
/* switch */
input[type=checkbox][role=switch]{
  appearance:none; width:2.5rem; height:1.35rem; border-radius:999px; background:var(--surface-3);
  position:relative; border:var(--bw-1) solid var(--color-border); vertical-align:middle; outline:none; transition:background .15s;
}
input[role=switch]::after{content:""; position:absolute; left:.15rem; top:50%; width:1rem; height:1rem; transform:translateY(-50%); background:#fff; border-radius:999px; box-shadow:var(--shadow-sm); transition:left .15s;}
input[role=switch]:checked{background:color-mix(in oklab,var(--primary) 40%,var(--surface-3));}
input[role=switch]:checked::after{left:calc(100% - 1.15rem);}
input[role=switch]:focus-visible{outline:var(--focus-ring) solid var(--primary); outline-offset:2px;}
/* range */
input[type=range]{appearance:none; width:100%; height:.25rem; border-radius:999px; background:var(--surface-3);}
input[type=range]::-webkit-slider-thumb{appearance:none; width:1rem; height:1rem; border-radius:50%; background:var(--primary); border:var(--bw-2) solid var(--color-bg); box-shadow:var(--shadow-sm);}
input[type=range]::-moz-range-thumb{width:1rem; height:1rem; border-radius:50%; background:var(--primary); border:var(--bw-2) solid var(--color-bg); box-shadow:var(--shadow-sm);}
input[type=range]:focus-visible{outline:var(--focus-ring) solid var(--primary); outline-offset:6px;}
/* file button */
input[type=file]::-webkit-file-upload-button{border:var(--bw-1) solid var(--color-border); border-radius:var(--radius); padding:.45em .8em; background:var(--surface-2); cursor:pointer;}
input[type=file]::file-selector-button{border:var(--bw-1) solid var(--color-border); border-radius:var(--radius); padding:.45em .8em; background:var(--surface-2); cursor:pointer;}
input[type=file]::file-selector-button:hover{background:var(--surface-3);}

/* ==========================================================================
   8) Breadcrumbs
   ========================================================================== */
nav[aria-label=breadcrumb] ol{display:flex; flex-wrap:wrap; gap:.35rem var(--m-0_5); padding:0; margin:0; list-style:none;}
nav[aria-label=breadcrumb] li{display:flex; align-items:center; color:var(--color-muted);}
nav[aria-label=breadcrumb] li+li::before{content:"/"; margin:0 .35rem; color:var(--color-border);}
nav[aria-label=breadcrumb] a{text-decoration:none;}
nav[aria-label=breadcrumb] a:hover{text-decoration:underline;}
nav[aria-label=breadcrumb] [aria-current=page]{color:inherit; font-weight:600;}

/* ==========================================================================
   9) Badges
   ========================================================================== */
[aria-label][data-badge]{position:relative;}
[aria-label][data-badge]::after{
  content:attr(data-badge); position:absolute; top:-.4em; right:-.4em; font-size:.7em; line-height:1;
  background:var(--primary); color:var(--on-primary); border-radius:999px; padding:.25em .45em; box-shadow:var(--shadow-sm);
}

/* ==========================================================================
   10) Busy/spinner — [aria-busy="true"]
   ========================================================================== */
@keyframes ivy-spin{to{transform:rotate(1turn);}}
[aria-busy=true]{position:relative;}
[aria-busy=true]::after{
  content:""; position:absolute; inset:auto .35rem .35rem auto; width:.9rem; height:.9rem;
  border:var(--bw-2) solid color-mix(in oklab,var(--primary) 20%,transparent); border-top-color:var(--primary);
  border-radius:50%; animation:ivy-spin .8s linear infinite;
}

/* ==========================================================================
   11) Containers — card / box
   ========================================================================== */
.card,.box{color:inherit; border:var(--bw-1) solid var(--color-border); border-radius:var(--radius); padding:var(--m);}
.card{box-shadow:var(--shadow-sm);}
.card:hover{box-shadow:var(--shadow-md); transition:box-shadow .15s ease;}
.card>footer,.card>header{margin:calc(var(--m)*-1); margin-bottom:var(--m); padding:var(--m);}
.card>header :is(h1,h2,h3,h4,h5,h6){margin:0;}
.card>header{border-bottom:var(--bw-1) solid var(--color-border); border-radius:calc(var(--radius) - 1px) calc(var(--radius) - 1px) 0 0;}
.card>footer{border-top:var(--bw-1) solid var(--color-border); border-radius:0 0 calc(var(--radius) - 1px) calc(var(--radius) - 1px);}
.card[data-variant=soft],.box[data-variant=soft]{background:var(--surface-2);}
.card[data-variant=primary],.box[data-variant=primary]{border-color:color-mix(in oklab,var(--primary) 45%,var(--color-border)); box-shadow:0 0 0 1px color-mix(in oklab,var(--primary) 20%,transparent),var(--shadow-sm);}
[data-padding=sm]{padding:.65rem;}
[data-padding=lg]{padding:1.25rem;}

/* ==========================================================================
   12) Callouts
   ========================================================================== */
.callout{border:var(--bw-1) solid var(--color-border); border-radius:var(--radius); padding:var(--m-0_75) var(--m); background:var(--surface-2);}
.callout>strong{display:block; margin-bottom:.25rem;}
.callout[data-tone=info]{border-color:color-mix(in oklab,var(--color-link) 30%,var(--color-border)); background:color-mix(in oklab,var(--color-link) 7%,var(--surface-2));}
.callout[data-tone=success]{--ok:#22c55e; border-color:color-mix(in oklab,var(--ok) 30%,var(--color-border)); background:color-mix(in oklab,var(--ok) 7%,var(--surface-2));}
.callout[data-tone=warn]{--warn:#f59e0b; border-color:color-mix(in oklab,var(--warn) 30%,var(--color-border)); background:color-mix(in oklab,var(--warn) 7%,var(--surface-2));}
.callout[data-tone=danger]{--danger:#ef4444; border-color:color-mix(in oklab,var(--danger) 30%,var(--color-border)); background:color-mix(in oklab,var(--danger) 7%,var(--surface-2));}

/* ==========================================================================
   13) Button groups
   ========================================================================== */
.btn-group{display:flex; flex-wrap:wrap; gap:var(--m-0_5);}
.btn-group[data-align=center]{justify-content:center;}
.btn-group[data-align=end]{justify-content:flex-end;}

/* ==========================================================================
   14) Input groups
   ========================================================================== */
.input-group{display:flex; align-items:stretch; gap:0;}
.input-group>*{margin:0;}
.input-group> :is(button,[type=button],[type=submit],[type=reset],.addon){border-radius:0; border-right:0;}
.input-group> :is(input,select,textarea){border-radius:0; flex:1 1 auto;}
.input-group>:first-child{border-top-left-radius:var(--radius); border-bottom-left-radius:var(--radius);}
.input-group>:last-child{border-right:var(--bw-1) solid var(--color-border); border-top-right-radius:var(--radius); border-bottom-right-radius:var(--radius);}
.addon{display:inline-flex; align-items:center; padding:.5em .7em; background:var(--surface-2); border:var(--bw-1) solid var(--color-border); color:var(--color-muted);}

/* ==========================================================================
   15) Tables — compact/dense variants
   ========================================================================== */
table[data-compact] th,table[data-compact] td{padding:.45rem .6rem;}
table[data-dense] th,table[data-dense] td{padding:.35rem .5rem; font-size:.95em;}

/* ==========================================================================
   16) Utilities
   ========================================================================== */
.divider{height:1px; background:var(--color-border); margin:var(--m) 0;}
.surface-2{background:var(--surface-2);}
.surface-3{background:var(--surface-3);}
.muted a{color:color-mix(in oklab,var(--color-link) 70%,var(--color-muted));}
